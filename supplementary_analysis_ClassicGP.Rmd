---
title: "temp"
author: "Kuan-Jung Huang"
date: "2022/3/1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(lme4)
library(ggplot2)
library(brms)
library(reshape2)
library(egg)
library(gridExtra)
library(grid)
```



###look at syntactic adaption
```{r}
rt.data <- read.csv("ClassicGardenPathSet.csv", header=TRUE) %>%
  filter(ROI %in% c(-2,-1,0,1,2)) %>%
  filter(RT <= 7000) %>% mutate(participant=MD5)
rt.data$SZM1 <- ifelse(
  rt.data$CONSTRUCTION=="NPS",1,0
)
rt.data$SZM2 <- ifelse(
  rt.data$CONSTRUCTION=="NPZ",1,0
)
numbeachcell <- distinct(rt.data,participant,Type,item,trialnumber) %>% group_by(participant,Type) %>% mutate(numbeachcell=n()) %>% ungroup() %>%  arrange(participant,Type,trialnumber) %>% distinct(participant,Type,numbeachcell)
Seq_each_cell_eachparticipant <-c()
for(i in 1:nrow(numbeachcell)){Seq_each_cell_eachparticipant <- c(Seq_each_cell_eachparticipant,1:as.numeric(numbeachcell[i,'numbeachcell']))
}
rt.data <- left_join(rt.data,distinct(rt.data,participant,item) %>% mutate(seq_each_cell_eachparticipant=Seq_each_cell_eachparticipant))
rt.data$seq_each_cell_eachparticipant <- as.factor(rt.data$seq_each_cell_eachparticipant)
#takes forever to run the model with full random slopes
lmer_0_AMBxCONSTRxSeq <- lmer(RT ~ AMBUAMB*(SZM1+SZM2)*seq_each_cell_eachparticipant +(1|item)+(1|participant),data=rt.data[rt.data$ROI==0,])
summary(lmer_0_AMBxCONSTRxSeq)
rt.data$Type_sumcoded1 <- ifelse(rt.data$Type=="NPS_UAMB",5/6,-1/6)
rt.data$Type_sumcoded2 <- ifelse(rt.data$Type=="NPZ_AMB",5/6,-1/6)
rt.data$Type_sumcoded3 <- ifelse(rt.data$Type=="NPZ_UAMB",5/6,-1/6)
rt.data$Type_sumcoded4 <- ifelse(rt.data$Type=="MVRR_AMB",5/6,-1/6)
rt.data$Type_sumcoded5 <- ifelse(rt.data$Type=="MVRR_UAMB",5/6,-1/6)
#takes forever to run the model with full random slopes
lmer_0_TypexSeq <- lmer(RT ~ (Type_sumcoded1+Type_sumcoded2+Type_sumcoded3+Type_sumcoded4+Type_sumcoded5)*seq_each_cell_eachparticipant +(1|item)+(1|participant),data=rt.data[rt.data$ROI==0,])
summary(lmer_0_TypexSeq)
#lmer_0_TypexSeq_full <- lmer(RT ~ (Type_sumcoded1+Type_sumcoded2+Type_sumcoded3+Type_sumcoded4+Type_sumcoded5)*seq_each_cell_eachparticipant +(1+(Type_sumcoded1+Type_sumcoded2+Type_sumcoded3+Type_sumcoded4+Type_sumcoded5)*seq_each_cell_eachparticipant||item)+(1+(Type_sumcoded1+Type_sumcoded2+Type_sumcoded3+Type_sumcoded4+Type_sumcoded5)*seq_each_cell_eachparticipant||participant),data=rt.data[rt.data$ROI==0,])
#summary(lmer_0_TypexSeq_full)
```




### does surprisal from NNs capture plausibility?
```{r}
lm_prediction <- read.csv("lm_prediction_postcombined.csv",header=T)
surprisal_and_plaus <- read.csv("local_plausibility_lmprediction.csv",header=T)
cor.test(surprisal_and_plaus$surprisal_gpt2,surprisal_and_plaus$plau_local)
cor.test(surprisal_and_plaus$surprisal_lstm,surprisal_and_plaus$plau_local)
cor.test(surprisal_and_plaus$surprisal_rnng,surprisal_and_plaus$plau_local)
ggplot(surprisal_and_plaus, aes(x=surprisal_gpt2, y=plau_local, colour=Construction)) +
  geom_point()+
  ggtitle("cor = -0.54")+
  labs(x = 'surprisal of "operation" given "The doctor left the", GPT', y = 'Local plausibility (The doctor left the operation)')
ggplot(surprisal_and_plaus, aes(x=surprisal_lstm, y=plau_local, colour=Construction)) +
  geom_point()+
  ggtitle("cor = -0.50")+
  labs(x = 'surprisal of "operation" given "The doctor left the", LSTM', y = 'Local plausibility (The doctor left the operation)')
ggplot(surprisal_and_plaus, aes(x=surprisal_rnng, y=plau_local, colour=Construction)) +
  geom_point()+
  ggtitle("cor = -0.28")+
  labs(x = 'surprisal of "operation" given "The doctor left the", rnng', y = 'Local plausibility (The doctor left the operation)')
```


### human cloze responses and GPEs (at disambiguating verb)
```{r}
#loose: consider all VP responses as S/Z/RR (even though the VP can be another reduced relative clause)
#strict: only clearly finite VP as S/Z/RR responses
cor.test(lm_prediction$ITEM72_MEAN_P0,lm_prediction$cloze_prob_strict)
cor.test(lm_prediction$ITEM72_MEAN_P0,lm_prediction$cloze_prob_loose)
#NPS
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=1,to=72,by=3)],
         lm_prediction$cloze_prob_strict[seq(from=1,to=72,by=3)])
#NPZ
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=2,to=72,by=3)],
         lm_prediction$cloze_prob_strict[seq(from=2,to=72,by=3)])
#MVRR
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=3,to=72,by=3)],
         lm_prediction$cloze_prob_strict[seq(from=3,to=72,by=3)])
#NPS
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=1,to=72,by=3)],
         lm_prediction$cloze_prob_loose[seq(from=1,to=72,by=3)])
#NPZ
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=2,to=72,by=3)],
         lm_prediction$cloze_prob_loose[seq(from=2,to=72,by=3)])
#MVRR
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=3,to=72,by=3)],
         lm_prediction$cloze_prob_loose[seq(from=3,to=72,by=3)])
GPE_predictedby_syntactic_cloze_prob_strict <- ggplot(lm_prediction, aes(x=cloze_prob_strict, y=ITEM72_MEAN_P0, colour=Type)) +
  geom_point()+
  ggtitle("GPEs predicted by human syntactic cloze")+
  labs(x = 'percentage of S/Z/RR_strict', y = 'GPEs')
GPE_predictedby_syntactic_cloze_prob_loose <- ggplot(lm_prediction, aes(x=cloze_prob_loose, y=ITEM72_MEAN_P0, colour=Type)) +
  geom_point()+
  ggtitle("GPEs predicted by human syntactic cloze")+
  labs(x = 'percentage of S/Z/RR_loose', y = 'GPEs')
GPE_predictedby_syntactic_cloze_prob_strict <- set_panel_size(GPE_predictedby_syntactic_cloze_prob_strict,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
GPE_predictedby_syntactic_cloze_prob_loose <- set_panel_size(GPE_predictedby_syntactic_cloze_prob_loose,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
grid.arrange(GPE_predictedby_syntactic_cloze_prob_strict,GPE_predictedby_syntactic_cloze_prob_loose,ncol=2)
```



### human plausibility and GPEs (at disambiguating verb)
```{r}
#NPS
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=1,to=72,by=3)],
         lm_prediction$plau_local[seq(from=1,to=72,by=3)])
#NPZ
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=2,to=72,by=3)],
         lm_prediction$plau_local[seq(from=2,to=72,by=3)])
#MVRR
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=3,to=72,by=3)],
         lm_prediction$plau_local[seq(from=3,to=72,by=3)])
#NPZ
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=2,to=72,by=3)],
         lm_prediction$plau_ultimate[seq(from=2,to=72,by=3)])
#MVRR
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=3,to=72,by=3)],
         lm_prediction$plau_ultimate[seq(from=3,to=72,by=3)])
GPE_predictedby_localplausibility <- ggplot(lm_prediction, aes(x=plau_local, y=ITEM72_MEAN_P0, colour=Type)) +
  geom_point()+
  ggtitle("GPEs predicted by plausibility (human normed)")+
  labs(x = 'Local plausibility (e.g., The boy attacked the chicken.)', y = 'GPEs')
GPE_predictedby_localplausibility <- set_panel_size(GPE_predictedby_localplausibility,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
plot(GPE_predictedby_localplausibility)
GPE_predictedby_ultimateplausibility <-
  ggplot(lm_prediction, aes(x=plau_ultimate, y=ITEM72_MEAN_P0, colour=Type)) +
  geom_point()+
  labs(x = 'Ultimate plausibility (e.g., The boy attacked.)', y = 'GPEs')
GPE_predictedby_ultimateplausibility <- set_panel_size(GPE_predictedby_ultimateplausibility,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
```


### verb bias from COCA and GPEs (at disambiguating verb)
```{r}
#NPS
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=1,to=72,by=3)],
         lm_prediction$corpus_verb_bias[seq(from=1,to=72,by=3)])
#NPZ
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=2,to=72,by=3)],
         lm_prediction$corpus_verb_bias[seq(from=2,to=72,by=3)])
#MVRR
cor.test(lm_prediction$ITEM72_MEAN_P0[seq(from=3,to=72,by=3)],
         lm_prediction$corpus_verb_bias[seq(from=3,to=72,by=3)])
GPE_predictedby_corpusverbbias <-
  ggplot(lm_prediction, aes(x=corpus_verb_bias, y=ITEM72_MEAN_P0, colour=Type)) +
  geom_point()+
  ggtitle("GPEs predicted by verb bias as calculated from COCA")+
  labs(x = 'Percentage of S/Z/RR', y = 'GPEs')
GPE_predictedby_corpusverbbias <- set_panel_size(GPE_predictedby_corpusverbbias,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
plot(GPE_predictedby_corpusverbbias)
```


###Spillover 1
###GPEs and surprisal
```{r}
cor.test(lm_prediction$ITEM_MEAN_P1,lm_prediction$lstmsurprisaldiff_ambminusuamb)
cor.test(lm_prediction$ITEM_MEAN_P1,lm_prediction$gpt2surprisaldiff_ambminusuamb)
cor.test(lm_prediction$ITEM_MEAN_P1,lm_prediction$rnngsurprisaldiff_ambminusuamb)


lstm_itemgpe_by_surprisal_P1 <- ggplot(lm_prediction,aes(x=lstmsurprisaldiff_ambminusuamb,y=ITEM_MEAN_P1,color=Type))+
  labs(title = "r =0.34, (LSTM)")+
  xlab("")+
  ylab("")+
  geom_pointrange(aes(ymin=HDI_low_P1, ymax=HDI_high_P1))+
  theme(axis.text.x = element_text(size=13),
        axis.text.y = element_text(size=12),
        plot.title = element_text(size = 13))
lstm_itemgpe_by_surprisal_P1 <- set_panel_size(lstm_itemgpe_by_surprisal_P1,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
gpt2_itemgpe_by_surprisal_P1 <- ggplot(lm_prediction,aes(x=gpt2surprisaldiff_ambminusuamb,y=ITEM_MEAN_P1,col=Type))+
  labs(title = "r =0.47, (GPT-2)")+
  xlab("")+
  ylab("")+
  geom_pointrange(aes(ymin=HDI_low_P1, ymax=HDI_high_P1))+
  theme(axis.text.x = element_text(size=13),
        axis.text.y = element_text(size=12),
        plot.title = element_text(size = 13))
gpt2_itemgpe_by_surprisal_P1 <- set_panel_size(gpt2_itemgpe_by_surprisal_P1,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
grid.arrange(lstm_itemgpe_by_surprisal_P1,
             gpt2_itemgpe_by_surprisal_P1,ncol=2,
             bottom=textGrob("Surprisal difference at the disambiguating verb (ambig - unambig)", gp=gpar(fontsize=14)),
             left=textGrob("Empirical Garden Path Effect at Spillover1", gp=gpar(fontsize=14),rot=90))


#cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPS"],lm_prediction$lstmsurprisaldiff_ambminusuamb[lm_prediction$Type=="NPS"])
#NPS
NPS_itemgpe_by_lstmsurprisal_P1 <- ggplot(lm_prediction[lm_prediction$Type=="NPS",],aes(x=lstmsurprisaldiff_ambminusuamb,y=ITEM_MEAN_P1))+
  labs(title = "r = 0.59, (NPS)")+
  xlab("")+
  ylab("")+
  geom_pointrange(aes(ymin=HDI_low_P1, ymax=HDI_high_P1),color="green4")+
  theme(axis.text.x = element_text(size=10),
        axis.text.y = element_text(size=10),
        plot.title = element_text(size = 10))
NPS_itemgpe_by_lstmsurprisal_P1 <- set_panel_size(NPS_itemgpe_by_lstmsurprisal_P1,width=unit(4,"cm"),height=unit(4,"cm"))
#NPZ
#cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPZ"],lm_prediction$lstmsurprisaldiff_ambminusuamb[lm_prediction$Type=="NPZ"])
NPZ_itemgpe_by_lstmsurprisal_P1 <- ggplot(lm_prediction[lm_prediction$Type=="NPZ",],aes(x=lstmsurprisaldiff_ambminusuamb,y=ITEM_MEAN_P1))+
  labs(title = "r = 0.27, (NPZ)")+
  xlab("")+
  ylab("")+
  geom_pointrange(aes(ymin=HDI_low_P1, ymax=HDI_high_P1),color="blue")+
  theme(axis.text.x = element_text(size=10),
        axis.text.y = element_text(size=10),
        plot.title = element_text(size = 10))
NPZ_itemgpe_by_lstmsurprisal_P1 <- set_panel_size(NPZ_itemgpe_by_lstmsurprisal_P1,width=unit(4,"cm"),height=unit(4,"cm"))
#MVRR
#cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="MVRR"],lm_prediction$lstmsurprisaldiff_ambminusuamb[lm_prediction$Type=="MVRR"])
MVRR_itemgpe_by_lstmsurprisal_P1 <- ggplot(lm_prediction[lm_prediction$Type=="MVRR",],aes(x=lstmsurprisaldiff_ambminusuamb,y=ITEM_MEAN_P1))+
  labs(title = "r = 0.39, (Wiki-LSTM, MVRR)")+
  xlab("")+
  ylab("")+
  geom_pointrange(aes(ymin=HDI_low_P1, ymax=HDI_high_P1),color="red")+
  theme(axis.text.x = element_text(size=10),
        axis.text.y = element_text(size=10),
        plot.title = element_text(size = 10))
MVRR_itemgpe_by_lstmsurprisal_P1 <- set_panel_size(MVRR_itemgpe_by_lstmsurprisal_P1,width=unit(4,"cm"),height=unit(4,"cm"))
###gpt2
#NPS
#cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPS"],lm_prediction$gptsurprisaldiff_ambminusuamb[lm_prediction$Type=="NPS"])
NPS_itemgpe_by_gpt2surprisal_P1 <- ggplot(lm_prediction[lm_prediction$Type=="NPS",],aes(x=gpt2surprisaldiff_ambminusuamb,y=ITEM_MEAN_P1))+
  labs(title = "r = 0.52, (NPS)")+
  xlab("")+
  ylab("")+
  geom_pointrange(aes(ymin=HDI_low_P1, ymax=HDI_high_P1),color="green4")+
  theme(axis.text.x = element_text(size=10),
        axis.text.y = element_text(size=10),
        plot.title = element_text(size = 10))
NPS_itemgpe_by_gpt2surprisal_P1 <- set_panel_size(NPS_itemgpe_by_gpt2surprisal_P1,width=unit(4,"cm"),height=unit(4,"cm"))
#NPZ
#cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPZ"],lm_prediction$gptsurprisaldiff_ambminusuamb[lm_prediction$Type=="NPZ"])
NPZ_itemgpe_by_gpt2surprisal_P1 <- ggplot(lm_prediction[lm_prediction$Type=="NPZ",],aes(x=gpt2surprisaldiff_ambminusuamb,y=ITEM_MEAN_P1))+
  labs(title = "r = 0.25, (NPZ)")+
  xlab("")+
  ylab("")+
  geom_pointrange(aes(ymin=HDI_low_P1, ymax=HDI_high_P1),color="blue")+
  theme(axis.text.x = element_text(size=10),
        axis.text.y = element_text(size=10),
        plot.title = element_text(size = 10))
NPZ_itemgpe_by_gpt2surprisal_P1 <- set_panel_size(NPZ_itemgpe_by_gpt2surprisal_P1,width=unit(4,"cm"),height=unit(4,"cm"))
#MVRR
#cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="MVRR"],lm_prediction$gptsurprisaldiff_ambminusuamb[lm_prediction$Type=="MVRR"])
MVRR_itemgpe_by_gpt2surprisal_P1 <- ggplot(lm_prediction[lm_prediction$Type=="MVRR",],aes(x=gpt2surprisaldiff_ambminusuamb,y=ITEM_MEAN_P1))+
  labs(title = "r =0.09, (GPT-2, MVRR)")+
  xlab("")+
  ylab("")+
  geom_pointrange(aes(ymin=HDI_low_P1, ymax=HDI_high_P1),color="red")+
  theme(axis.text.x = element_text(size=10),
        axis.text.y = element_text(size=10),
        plot.title = element_text(size = 10))
MVRR_itemgpe_by_gpt2surprisal_P1 <- set_panel_size(MVRR_itemgpe_by_gpt2surprisal_P1,width=unit(4,"cm"),height=unit(4,"cm"))
grid.arrange(MVRR_itemgpe_by_lstmsurprisal_P1,
             NPS_itemgpe_by_lstmsurprisal_P1,
             NPZ_itemgpe_by_lstmsurprisal_P1,
             MVRR_itemgpe_by_gpt2surprisal_P1,
             NPS_itemgpe_by_gpt2surprisal_P1,
             NPZ_itemgpe_by_gpt2surprisal_P1,nrow=2,
             bottom=textGrob("Surprisal difference at the disambiguating verb (ambig - unambig)", gp=gpar(fontsize=14)),
             left=textGrob("Empirical Garden Path Effect at Spillover1", gp=gpar(fontsize=14),rot=90))
```



### human cloze responses and GPEs (at disambiguating verb)
```{r}
cor.test(lm_prediction$ITEM_MEAN_P1,lm_prediction$cloze_prob_strict)
cor.test(lm_prediction$ITEM_MEAN_P1,lm_prediction$cloze_prob_loose)
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPS"],lm_prediction$cloze_prob_strict[lm_prediction$Type=="NPS"])
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPZ"],lm_prediction$cloze_prob_strict[lm_prediction$Type=="NPZ"])
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="MVRR"],lm_prediction$cloze_prob_strict[lm_prediction$Type=="MVRR"])
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPS"],lm_prediction$cloze_prob_loose[lm_prediction$Type=="NPS"])
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPZ"],lm_prediction$cloze_prob_loose[lm_prediction$Type=="NPZ"])
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="MVRR"],lm_prediction$cloze_prob_loose[lm_prediction$Type=="MVRR"])

GPE_predictedby_syntactic_cloze_prob_strict_P1 <- ggplot(lm_prediction, aes(x=cloze_prob_strict, y=ITEM_MEAN_P1, colour=Type)) +
  geom_point()+
  ggtitle("GPEs predicted by human syntactic cloze")+
  labs(x = 'percentage of S/Z/RR_strict', y = 'GPEs')
GPE_predictedby_syntactic_cloze_prob_loose_P1 <- ggplot(lm_prediction, aes(x=cloze_prob_loose, y=ITEM_MEAN_P1, colour=Type)) +
  geom_point()+
  ggtitle("GPEs predicted by human syntactic cloze")+
  labs(x = 'percentage of S/Z/RR_loose', y = 'GPEs')
GPE_predictedby_syntactic_cloze_prob_strict_P1 <- set_panel_size(GPE_predictedby_syntactic_cloze_prob_strict_P1,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
GPE_predictedby_syntactic_cloze_prob_loose_P1 <- set_panel_size(GPE_predictedby_syntactic_cloze_prob_loose_P1,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
grid.arrange(GPE_predictedby_syntactic_cloze_prob_strict_P1,GPE_predictedby_syntactic_cloze_prob_loose_P1,ncol=2)
```


### human plausibility and GPEs (at Spillover 1)
```{r}
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPS"],lm_prediction$plau_local[lm_prediction$Type=="NPS"])
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPZ"],lm_prediction$plau_local[lm_prediction$Type=="NPZ"])
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="MVRR"],lm_prediction$plau_local[lm_prediction$Type=="MVRR"])
GPE_predictedby_localplausibility_P1 <- ggplot(lm_prediction, aes(x=plau_local, y=ITEM_MEAN_P1, colour=Type)) +
  geom_point()+
  ggtitle("GPEs predicted by plausibility (human normed)")+
  labs(x = 'Local plausibility (e.g., The boy attacked the chicken.)', y = 'GPEs')
GPE_predictedby_localplausibility_P1 <- set_panel_size(GPE_predictedby_localplausibility_P1,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
plot(GPE_predictedby_localplausibility_P1)
GPE_predictedby_ultimateplausibility_P1 <-
  ggplot(lm_prediction, aes(x=plau_ultimate, y=ITEM_MEAN_P1, colour=Type)) +
  geom_point()+
  labs(x = 'Ultimate plausibility (e.g., The boy attacked.)', y = 'GPEs')
GPE_predictedby_ultimateplausibility_P1 <- set_panel_size(GPE_predictedby_ultimateplausibility_P1,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
plot(GPE_predictedby_ultimateplausibility_P1)
```




### verb bias from COCA and GPEs (at Spillover 1)
```{r}
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPS"],lm_prediction$corpus_verb_bias[lm_prediction$Type=="NPS"])
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="NPZ"],lm_prediction$corpus_verb_bias[lm_prediction$Type=="NPZ"])
cor.test(lm_prediction$ITEM_MEAN_P1[lm_prediction$Type=="MVRR"],lm_prediction$corpus_verb_bias[lm_prediction$Type=="MVRR"])
GPE_predictedby_corpusverbbias_P1 <-
  ggplot(lm_prediction, aes(x=corpus_verb_bias, y=ITEM_MEAN_P1, colour=Type)) +
  geom_point()+
  ggtitle("GPEs predicted by verb bias as calculated from COCA")+
  labs(x = 'Percentage of S/Z/RR', y = 'GPEs at spillover1')
GPE_predictedby_corpusverbbias_P1 <- set_panel_size(GPE_predictedby_corpusverbbias_P1,width=unit(7.5,"cm"),height=unit(7.5,"cm"))
plot(GPE_predictedby_corpusverbbias_P1)
```